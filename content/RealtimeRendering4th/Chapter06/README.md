# 第6章 纹理
* 给表面贴纹理可以使用两张纹理，第一张纹理改变表面的颜色，第二章纹理改变表面的粗糙度. 例如使用不同的粗糙度表现墙壁上的砖块和砖块之间的砂浆部分。使用 bump mapping 生成墙壁的凹凸不平效果。使用 Parallax mapping 使用一张纹理变形平坦的表面，parallax occlusion mapping 在一张高度场纹理上发射射线以提升真实度。Displacement mapping 通过修改三角形高度来移动表面。

![](Media/Figure_06_01.png)

上图中使用了纹理和bump map

## 1. 纹理管线

![](Media/Figure_06_02.png)

![](Media/Figure_06_03.png)

* 当纹理的颜色位于 sRGB 空间，在用与着色公式的过程中，应将其转换至线性空间。
* 常见的纹理投影有球形，圆柱形，平面投影。

![](Media/Figure_06_04.png)

    上图分别演示球形，圆柱形，平面，自然投影，底下一行则分别演示球形，圆柱形和平面投影。

* 纹理投影可以使用其他的输入，例如表面的法线可用于选择六个平面投影方向中的一个作为表面的纹理投影。通常在建模阶段使用投影函数设置顶点的投影结果，不过有时也根据需要在顶点和片段着色器中使用投影函数设置纹理坐标。
* 球面投影与环境映射方案(environment mapping scheme)使用的投影相同，可见(10.4.1节)。圆柱投影的水平纹理坐标u和球面投影相同，纵向纹理坐标v则圆柱轴方向上的距离。平面投影则使用正交投影将图像投影至表面上，可用于贴花。
* 美工通常将模型分解为接近平面的部分，或展开网格，或生成一组接近最佳的平面投影集解决纹理投影的变形问题，感兴趣的话可见Hormann的SIGGARAPH的课程笔记[774]
* 三维纹理使用(u,v,w)三元组坐标。当使用4元组坐标时，可以将q作为齐次坐标的第四个值，实现类似于将灯上的装饰图案投影到舞台或者其他物体表面上时的效果。
* 同时还有cube map和一维纹理，一维纹理可以确定一个地形中不同高度下的颜色，如山脚为绿色，山顶为白色。同时线条也可以使用纹理，将雨水渲染成带半透明图形的线条。
* Corresponder functions 将纹理坐标转换至纹理空间的位置。通常使用 API 函数实现该功能。如 GLSL 的 texture 函数。另一种类型的 corresponder 则为一个矩阵变换，在顶点或片段着色器中使用，允许表面上的纹理执行平移，旋转，缩放，切变，投影操作。注意的是变换矩阵的顺序应当和想要的顺序相反。
* 纹理坐标位于[0,1]之外的处理: wrap,repeat,tile; mirror; clamp; boarder.
* 隐式的 corresponder function, [0, 1] 映射至一张图像上。

## 2 图像贴图(Image Texturing)